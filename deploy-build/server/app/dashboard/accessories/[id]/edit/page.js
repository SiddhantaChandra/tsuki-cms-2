(()=>{var e={};e.id=8375,e.ids=[8375],e.modules={16:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});var t=r(23428),i=r(60687);let a=(0,t.A)((0,i.jsx)("path",{d:"M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12z"}),"Label")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},12892:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});var t=r(23428),i=r(60687);let a=(0,t.A)((0,i.jsx)("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Star")},16524:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});var t=r(23428),i=r(60687);let a=(0,t.A)((0,i.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 16H8v-2h8zm0-4H8v-2h8zm-3-5V3.5L18.5 9z"}),"Description")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20045:(e,s,r)=>{Promise.resolve().then(r.bind(r,85415))},22253:(e,s,r)=>{Promise.resolve().then(r.bind(r,70482))},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},38703:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});var t=r(23428),i=r(60687);let a=(0,t.A)((0,i.jsx)("path",{d:"M12 13V9c0-.55-.45-1-1-1H7V6h5V4H9.5V3h-2v1H6c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h4v2H5v2h2.5v1h2v-1H11c.55 0 1-.45 1-1m7.59-.48-5.66 5.65-2.83-2.83-1.41 1.42L13.93 21 21 13.93z"}),"PriceCheck")},43323:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});var t=r(23428),i=r(60687);let a=(0,t.A)((0,i.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},43596:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});var t=r(23428),i=r(60687);let a=(0,t.A)((0,i.jsx)("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5"}),"Link")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},58547:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>c});var t=r(65239),i=r(48088),a=r(88170),o=r.n(a),n=r(30893),l={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);r.d(s,l);let c={children:["",{children:["dashboard",{children:["accessories",{children:["[id]",{children:["edit",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,70482)),"C:\\Users\\siddh\\Documents\\tsuki-cms-2\\app\\dashboard\\accessories\\[id]\\edit\\page.js"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,27577)),"C:\\Users\\siddh\\Documents\\tsuki-cms-2\\app\\dashboard\\layout.js"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,32648)),"C:\\Users\\siddh\\Documents\\tsuki-cms-2\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["C:\\Users\\siddh\\Documents\\tsuki-cms-2\\app\\dashboard\\accessories\\[id]\\edit\\page.js"],u={require:r,loadChunk:()=>Promise.resolve()},h=new t.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/dashboard/accessories/[id]/edit/page",pathname:"/dashboard/accessories/[id]/edit",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70482:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>t});let t=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\siddh\\\\Documents\\\\tsuki-cms-2\\\\app\\\\dashboard\\\\accessories\\\\[id]\\\\edit\\\\page.js\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\siddh\\Documents\\tsuki-cms-2\\app\\dashboard\\accessories\\[id]\\edit\\page.js","default")},74075:e=>{"use strict";e.exports=require("zlib")},77342:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});var t=r(23428),i=r(60687);let a=(0,t.A)((0,i.jsx)("path",{d:"m22 9.24-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28z"}),"StarBorder")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},84122:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});var t=r(23428),i=r(60687);let a=(0,t.A)((0,i.jsx)("path",{d:"M20 2H4c-1 0-2 .9-2 2v3.01c0 .72.43 1.34 1 1.69V20c0 1.1 1.1 2 2 2h14c.9 0 2-.9 2-2V8.7c.57-.35 1-.97 1-1.69V4c0-1.1-1-2-2-2m-5 12H9v-2h6zm5-7H4V4l16-.02z"}),"Inventory")},85415:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>J});var t=r(60687),i=r(43210),a=r(16189),o=r(2420),n=r(89431),l=r(41434),c=r(16184),d=r(88931),u=r(66803),h=r(87088),p=r(51067),m=r(12064),x=r(96926),g=r(25495),A=r(85126),b=r.n(A),j=r(21360),y=r(25685),f=r(49205),v=r(16393),C=r(51711),k=r(91176),S=r(23789),w=r(52260),q=r(41629),_=r(47651),I=r(9133),P=r(18811),z=r(83685),T=r(5294),$=r(43323),H=r(102),W=r(12892),D=r(77342),E=r(77780),U=r(38703),V=r(71411),L=r(29041),M=r(16),F=r(43596),N=r(16524),R=r(37402),B=r(84122),G=r(30476),O=r(85814),K=r.n(O),Y=r(88920),Q=r(26001);function X({accessory:e,categories:s,onSuccess:r}){let a=(0,o.U)(),n=(0,j.A)(),[x,A]=(0,i.useState)(e.name||""),[O,X]=(0,i.useState)(e.slug||""),[J,Z]=(0,i.useState)(e.description||""),[ee,es]=(0,i.useState)(e.category_id||""),[er,et]=(0,i.useState)(e.price?.toString()||""),[ei,ea]=(0,i.useState)(e.stock_quantity?.toString()||""),[eo,en]=(0,i.useState)(e.accessory_type||""),[el,ec]=(0,i.useState)(e.image_urls||[]),[ed,eu]=(0,i.useState)(e.thumbnail_url||""),[eh,ep]=(0,i.useState)([]),[em,ex]=(0,i.useState)(null),[eg,eA]=(0,i.useState)([]),[eb,ej]=(0,i.useState)(!1),[ey,ef]=(0,i.useState)(null),[ev,eC]=(0,i.useState)(""),[ek,eS]=(0,i.useState)({}),[ew,eq]=(0,i.useState)(0),e_=()=>{let e={};return x.trim()||(e.name="Name is required."),O.trim()||(e.slug="Slug is required."),ee||(e.categoryId="Category is required."),eo||(e.accessoryType="Accessory type is required."),(!er||isNaN(parseFloat(er))||0>=parseFloat(er))&&(e.price="Valid price is required."),(!ei||isNaN(parseInt(ei))||0>parseInt(ei))&&(e.stock="Valid stock quantity is required."),0===el.length&&0===eh.length&&(e.images="At least one image is required."),ed||em||(e.thumbnail="Thumbnail image is required."),eS(e),0===Object.keys(e).length},eI=(0,i.useCallback)(({mainImageFiles:e,thumbnailImageFile:s})=>{console.log("[EditAccessoryForm] handleImageUploadComplete called",{mainFiles:e?.length,thumbFile:s?.name}),e&&e.length>0&&ep(e),s&&ex(s),eS(e=>({...e,images:null,thumbnail:null}))},[]),eP=e=>{if(ec(el.filter(s=>s!==e)),eA(s=>[...s,e]),e===ed){let s=el.filter(s=>s!==e);s.length>0?eu(s[0]):eu("")}},ez=e=>{eu(e)},eT=async s=>{if(s.preventDefault(),!e_())return void ef("Please correct the errors in the form.");ej(!0),ef(null),eC("");try{let s=ed;if(em){let e=new Date().toISOString().split("T")[0].replace(/-/g,"/"),r=`thumb_${(0,g.A)()}_${b()(em.name,{lower:!0,strict:!0})}`,t=`accessories/${e}/${r}`,{error:i}=await a.storage.from("cardimages").upload(t,em);if(i)throw Error(`Thumbnail upload failed: ${i.message}`);let{data:o}=a.storage.from("cardimages").getPublicUrl(t);s=o.publicUrl}let t=[];if(eh.length>0)for(let e of eh){let s=new Date().toISOString().split("T")[0].replace(/-/g,"/"),r=`${(0,g.A)()}_${b()(e.name,{lower:!0,strict:!0})}`,i=`accessories/${s}/${r}`,{error:o}=await a.storage.from("cardimages").upload(i,e);if(o)throw Error(`Image upload failed for ${e.name}: ${o.message}`);let{data:n}=a.storage.from("cardimages").getPublicUrl(i);t.push(n.publicUrl)}if(eg.length>0)for(let e of eg){let s=e.split("/").slice(-2).join("/");try{await a.storage.from("cardimages").remove([`accessories/${s}`])}catch(e){console.error(`Failed to delete image: ${e.message}`)}}let i=[...el,...t];s&&!i.includes(s)&&i.push(s);let{error:o}=await a.from("accessories").update({name:x,slug:O,description:J,category_id:ee,accessory_type:eo,price:parseFloat(er),stock_quantity:parseInt(ei),image_urls:i,thumbnail_url:s,updated_at:new Date().toISOString()}).eq("id",e.id);if(o)throw Error(`Failed to update accessory: ${o.message}`);eC("Accessory updated successfully!"),ep([]),ex(null),eA([]),eq(e=>e+1),setTimeout(()=>{r&&"function"==typeof r&&r()},1500)}catch(e){console.error("Error updating accessory:",e),ef(e.message||"An unexpected error occurred.")}finally{ej(!1)}};return(0,t.jsxs)(d.A,{sx:{maxWidth:900,mx:"auto",p:3},children:[(0,t.jsxs)(d.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[(0,t.jsx)(h.A,{variant:"h4",component:"h1",sx:{fontWeight:700},children:"Edit Accessory"}),(0,t.jsx)(c.A,{component:K(),href:"/dashboard/accessories",variant:"outlined",startIcon:(0,t.jsx)(m.A,{}),sx:{borderRadius:2},children:"Back to Accessories"})]}),(0,t.jsx)(p.A,{elevation:0,sx:{borderRadius:2,overflow:"hidden"},children:(0,t.jsxs)(d.A,{component:"form",onSubmit:eT,sx:{p:3},children:[(0,t.jsxs)(Y.N,{children:[ey&&(0,t.jsx)(Q.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:(0,t.jsx)(l.A,{severity:"error",sx:{mb:3},onClose:()=>ef(null),children:ey})}),ev&&(0,t.jsx)(Q.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:(0,t.jsx)(l.A,{severity:"success",sx:{mb:3},onClose:()=>eC(""),children:ev})})]}),(0,t.jsxs)(d.A,{sx:{mb:4},children:[(0,t.jsxs)(h.A,{variant:"h6",sx:{mb:3,display:"flex",alignItems:"center",gap:1},children:[(0,t.jsx)(E.A,{color:"primary"}),"Basic Information"]}),(0,t.jsxs)(y.A,{spacing:3,children:[(0,t.jsxs)(f.A,{container:!0,spacing:2,children:[(0,t.jsx)(f.A,{item:!0,xs:12,sm:8,children:(0,t.jsx)(v.A,{required:!0,fullWidth:!0,id:"name",label:"Accessory Name",name:"name",value:x,onChange:e=>A(e.target.value),error:!!ek.name,helperText:ek.name,disabled:eb,InputProps:{startAdornment:(0,t.jsx)(C.A,{position:"start",children:(0,t.jsx)(M.A,{color:"action"})})}})}),(0,t.jsx)(f.A,{item:!0,xs:12,sm:4,children:(0,t.jsx)(v.A,{required:!0,fullWidth:!0,id:"slug",label:"Slug",name:"slug",value:O,onChange:e=>X(e.target.value),error:!!ek.slug,helperText:ek.slug,disabled:eb,InputProps:{startAdornment:(0,t.jsx)(C.A,{position:"start",children:(0,t.jsx)(F.A,{color:"action"})})}})})]}),(0,t.jsx)(v.A,{fullWidth:!0,id:"description",label:"Description",name:"description",multiline:!0,rows:4,value:J,onChange:e=>Z(e.target.value),disabled:eb,InputProps:{startAdornment:(0,t.jsx)(C.A,{position:"start",sx:{alignSelf:"flex-start",mt:1.5},children:(0,t.jsx)(N.A,{color:"action"})})}})]})]}),(0,t.jsx)(k.A,{sx:{my:4}}),(0,t.jsxs)(d.A,{sx:{mb:4},children:[(0,t.jsxs)(h.A,{variant:"h6",sx:{mb:3,display:"flex",alignItems:"center",gap:1},children:[(0,t.jsx)(U.A,{color:"primary"}),"Classification & Pricing"]}),(0,t.jsxs)(y.A,{spacing:3,children:[(0,t.jsxs)(f.A,{container:!0,spacing:2,children:[(0,t.jsx)(f.A,{item:!0,xs:12,sm:6,children:(0,t.jsxs)(S.A,{fullWidth:!0,required:!0,error:!!ek.categoryId,children:[(0,t.jsx)(w.A,{id:"category-label",children:"Category"}),(0,t.jsx)(q.A,{labelId:"category-label",id:"category",value:ee,label:"Category",onChange:e=>es(e.target.value),disabled:eb,children:s.map(e=>(0,t.jsx)(_.A,{value:e.id,children:e.name},e.id))}),ek.categoryId&&(0,t.jsx)(I.A,{children:ek.categoryId})]})}),(0,t.jsx)(f.A,{item:!0,xs:12,sm:6,children:(0,t.jsxs)(S.A,{fullWidth:!0,required:!0,error:!!ek.accessoryType,children:[(0,t.jsx)(w.A,{id:"accessory-type-label",children:"Accessory Type"}),(0,t.jsx)(q.A,{labelId:"accessory-type-label",id:"accessoryType",value:eo,label:"Accessory Type",onChange:e=>en(e.target.value),disabled:eb,children:["Binder","Sleeve","Toploader","Grading Service","Storage Box","Display Case","Other"].map(e=>(0,t.jsx)(_.A,{value:e,children:e},e))}),ek.accessoryType&&(0,t.jsx)(I.A,{children:ek.accessoryType})]})})]}),(0,t.jsxs)(f.A,{container:!0,spacing:2,children:[(0,t.jsx)(f.A,{item:!0,xs:12,sm:6,children:(0,t.jsx)(v.A,{required:!0,fullWidth:!0,id:"price",label:"Price",name:"price",type:"number",inputProps:{min:0,step:.01},value:er,onChange:e=>et(e.target.value),error:!!ek.price,helperText:ek.price,disabled:eb,InputProps:{startAdornment:(0,t.jsx)(C.A,{position:"start",children:(0,t.jsx)(R.A,{color:"action"})})}})}),(0,t.jsx)(f.A,{item:!0,xs:12,sm:6,children:(0,t.jsx)(v.A,{required:!0,fullWidth:!0,id:"stock",label:"Stock Quantity",name:"stock",type:"number",inputProps:{min:0,step:1},value:ei,onChange:e=>ea(e.target.value),error:!!ek.stock,helperText:ek.stock,disabled:eb,InputProps:{startAdornment:(0,t.jsx)(C.A,{position:"start",children:(0,t.jsx)(B.A,{color:"action"})})}})})]})]})]}),(0,t.jsx)(k.A,{sx:{my:4}}),(0,t.jsxs)(d.A,{sx:{mb:4},children:[(0,t.jsxs)(h.A,{variant:"h6",sx:{mb:3,display:"flex",alignItems:"center",gap:1},children:[(0,t.jsx)(V.A,{color:"primary"}),"Images & Thumbnail"]}),el.length>0&&(0,t.jsxs)(d.A,{sx:{mb:3},children:[(0,t.jsx)(h.A,{variant:"subtitle1",sx:{mb:2,fontWeight:500},children:"Current Images:"}),(0,t.jsx)(d.A,{sx:{display:"flex",flexWrap:"wrap",gap:2},children:el.map((e,s)=>(0,t.jsxs)(d.A,{sx:{position:"relative",width:120,height:168,borderRadius:2,overflow:"hidden",boxShadow:3},children:[(0,t.jsx)("img",{src:e,alt:`Accessory image ${s+1}`,style:{width:"100%",height:"100%",objectFit:"contain",border:e===ed?"2px solid #f9a825":"none",backgroundColor:"rgba(0,0,0,0.04)"}}),(0,t.jsxs)(d.A,{sx:{position:"absolute",bottom:0,left:0,right:0,display:"flex",justifyContent:"space-between",p:.75,background:"linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 70%, rgba(0,0,0,0) 100%)"},children:[(0,t.jsx)(P.A,{title:e===ed?"Current thumbnail":"Set as thumbnail",children:(0,t.jsx)(z.A,{size:"small",onClick:()=>ez(e),sx:{backgroundColor:e===ed?"rgba(249, 168, 37, 0.7)":"rgba(0,0,0,0.5)",color:"#fff","&:hover":{backgroundColor:e===ed?"rgba(249, 168, 37, 0.9)":"rgba(0,0,0,0.7)"}},children:e===ed?(0,t.jsx)(W.A,{}):(0,t.jsx)(D.A,{})})}),(0,t.jsx)(P.A,{title:"Remove image",children:(0,t.jsx)(z.A,{size:"small",onClick:()=>eP(e),sx:{backgroundColor:"rgba(220,0,0,0.5)",color:"#fff","&:hover":{backgroundColor:"rgba(220,0,0,0.7)"}},children:(0,t.jsx)($.A,{})})})]})]},s))})]}),(0,t.jsx)(l.A,{severity:"info",sx:{mb:2},children:"Upload new images to replace or add to the current ones (optional)"}),(0,t.jsx)(d.A,{sx:{p:3,border:"1px dashed",borderColor:ek.images?n.palette.error.main:n.palette.divider,borderRadius:2,bgcolor:"dark"===n.palette.mode?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.02)",transition:"all 0.2s"},children:(0,t.jsx)(G.A,{bucketName:"cardimages",pathPrefix:"accessories",onUploadComplete:eI,resetKey:ew,targetHeight:320,targetWidth:240})}),eh.length>0&&(0,t.jsx)(T.A,{in:!0,children:(0,t.jsxs)(l.A,{severity:"success",sx:{mt:2},icon:(0,t.jsx)(H.A,{}),children:[eh.length," new image(s) ready to upload.",em?" New thumbnail is set.":' You can set a new thumbnail using the "Make Thumb" button.']})}),ek.images&&(0,t.jsx)(I.A,{error:!0,sx:{ml:2,mt:.5},children:ek.images}),ek.thumbnail&&(0,t.jsx)(I.A,{error:!0,sx:{ml:2,mt:.5},children:ek.thumbnail})]}),(0,t.jsx)(k.A,{sx:{my:3}}),(0,t.jsxs)(y.A,{direction:"row",spacing:2,justifyContent:"flex-end",children:[(0,t.jsx)(c.A,{variant:"outlined",onClick:()=>window.history.back(),disabled:eb,children:"Cancel"}),(0,t.jsx)(c.A,{type:"submit",variant:"contained",disabled:eb,startIcon:eb?(0,t.jsx)(u.A,{size:20}):(0,t.jsx)(L.A,{}),sx:{minWidth:200,background:eb?void 0:`linear-gradient(45deg, ${n.palette.primary.main} 30%, ${n.palette.secondary.main} 90%)`},children:eb?"Saving Changes...":"Save Changes"})]})]})})]})}function J({params:e}){let{id:s}=e,r=(0,a.useRouter)(),g=(0,o.U)(),{isAdmin:A,isEditor:b}=(0,x.A)(),[j,y]=(0,i.useState)(null),[f,v]=(0,i.useState)([]),[C,k]=(0,i.useState)(!0),[S,w]=(0,i.useState)(null),[q,_]=(0,i.useState)(!1);(0,i.useCallback)(async()=>{k(!0),w(null);try{if(!(A()||b()))return void _(!0);let{data:e,error:r}=await g.from("accessories").select("*").eq("id",s).single();if(r)throw r;if(!e)throw Error("Accessory not found");y(e);let{data:t,error:i}=await g.from("categories").select("id, name").order("name",{ascending:!0});if(i)throw i;v(t||[])}catch(e){console.error("Error fetching data:",e),w("Failed to load data. Please try again.")}finally{k(!1)}},[s,g,A,b]);let I=()=>{r.push(`/dashboard/accessories/${s}`)};return q?(0,t.jsxs)(n.A,{maxWidth:"md",children:[(0,t.jsx)(l.A,{severity:"error",sx:{mt:4},children:"You do not have permission to edit accessory details."}),(0,t.jsx)(c.A,{variant:"outlined",startIcon:(0,t.jsx)(m.A,{}),onClick:I,sx:{mt:2},children:"Back to Accessory Details"})]}):C?(0,t.jsx)(n.A,{maxWidth:"md",children:(0,t.jsx)(d.A,{sx:{display:"flex",justifyContent:"center",mt:8},children:(0,t.jsx)(u.A,{})})}):S?(0,t.jsxs)(n.A,{maxWidth:"md",children:[(0,t.jsx)(l.A,{severity:"error",sx:{mt:4},children:S}),(0,t.jsx)(c.A,{variant:"outlined",startIcon:(0,t.jsx)(m.A,{}),onClick:I,sx:{mt:2},children:"Back to Accessory Details"})]}):j?(0,t.jsxs)(n.A,{maxWidth:"md",children:[(0,t.jsxs)(d.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:4,mb:3},children:[(0,t.jsx)(h.A,{variant:"h4",component:"h1",children:"Edit Accessory"}),(0,t.jsx)(c.A,{variant:"outlined",startIcon:(0,t.jsx)(m.A,{}),onClick:I,children:"Cancel"})]}),(0,t.jsx)(p.A,{elevation:3,sx:{p:0},children:(0,t.jsx)(X,{accessory:j,categories:f,onSuccess:()=>r.push(`/dashboard/accessories/${s}`)})})]}):(0,t.jsxs)(n.A,{maxWidth:"md",children:[(0,t.jsx)(l.A,{severity:"warning",sx:{mt:4},children:"Accessory not found."}),(0,t.jsx)(c.A,{variant:"outlined",startIcon:(0,t.jsx)(m.A,{}),onClick:()=>r.push("/dashboard/accessories"),sx:{mt:2},children:"Back to Accessories"})]})}},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96926:(e,s,r)=>{"use strict";r.d(s,{A:()=>o});var t=r(43210),i=r(2420);async function a(e,s,r){let{data:t,error:i}=await e.from("user_roles").select(`
      role_id,
      roles:role_id (
        role_permissions (
          permission_id,
          permissions:permission_id (
            name
          )
        )
      )
    `).eq("user_id",s);return i?(console.error("Error checking user permission:",i),!1):t.some(e=>e.roles.role_permissions.some(e=>e.permissions.name===r))}function o(){let e=(0,i.U)(),[s,r]=(0,t.useState)(!0),[o,n]=(0,t.useState)(null),[l,c]=(0,t.useState)(null),[d,u]=(0,t.useState)([]),[h,p]=(0,t.useState)(!1),m=(0,t.useCallback)(e=>!!h&&!s&&!!l&&!!d&&0!==d.length&&d.some(s=>s&&s.name===e),[h,s,l,d]),x=(0,t.useCallback)(async r=>{if(!h||s||!l)return!1;try{return await a(e,l,r)}catch(e){return console.error("Error checking permission:",e.message||e),!1}},[h,s,e,l]),g=(0,t.useCallback)(()=>m("admin"),[m]),A=(0,t.useCallback)(()=>m("editor")||m("admin"),[m]),b=(0,t.useCallback)(()=>m("viewer")||m("editor")||m("admin"),[m]);return{userId:l,userRoles:d,loading:s,error:o,initialized:h,checkRole:m,checkPermission:x,isAdmin:g,isEditor:A,isViewer:b}}}};var s=require("../../../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[4447,1103,1658,4468,2153,4112,8164,8102,6393,9205,5814,8743,8811,8064,3156,476],()=>r(58547));module.exports=t})();