(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1038],{9521:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>H});var s=t(95155),a=t(12115),i=t(35695),n=t(67217),o=t(18407),c=t(71803),l=t(700),d=t(41101),h=t(68534),u=t(92302),x=t(78449),g=t(33989),A=t(54581),j=t(14426),m=t(63148),v=t(65528),y=t(85222),p=t(3127),b=t(74964),f=t(18987),C=t(27088),w=t(17348),k=t(68104),I=t(76380),S=t(56278),z=t(54492),N=t(99927),B=t(71977),R=t(60760),_=t(76408),L=t(55954),M=t(28890),W=t(19505),F=t(63954),E=t(94424),J=t(40857),O=t(37857),P=t(40510),V=t(88806);function H(){let[e,r]=(0,a.useState)([]),[t,H]=(0,a.useState)([]),[U,D]=(0,a.useState)(!0),[T,Z]=(0,a.useState)(null),[G,X]=(0,a.useState)(null),Y=(0,L.U)(),q=(0,i.useRouter)(),[Q,K]=(0,a.useState)(""),[$,ee]=(0,a.useState)(!1),[er,et]=(0,a.useState)({sortBy:"name_asc"}),[es,ea]=(0,a.useState)(!1),[ei,en]=(0,a.useState)(null),eo=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:er;D(!0),Z(null);try{let t=Y.from("categories").select("id, name, slug");switch(e.sortBy){case"newest":t=t.order("created_at",{ascending:!1});break;case"oldest":t=t.order("created_at",{ascending:!0});break;case"name_asc":default:t=t.order("name",{ascending:!0});break;case"name_desc":t=t.order("name",{ascending:!1})}let{data:s,error:a}=await t;if(a)throw a;r(s||[]),ec(s||[],Q)}catch(e){console.error("Error fetching categories:",e),Z("Failed to load categories. Please try refreshing the page.")}finally{D(!1)}},[Y,er,Q]);(0,a.useEffect)(()=>{eo()},[eo]);let ec=(e,r)=>{if(!r.trim())return void H(e);H(e.filter(e=>e.name.toLowerCase().includes(r.toLowerCase())))},el=r=>{K(r),ec(e,r)},ed=e=>{et(e),eo(e),ee(!1)},eh=e=>{q.push("/dashboard/categories/".concat(e,"/edit"))},eu=async()=>{if(ei){D(!0),Z(null),X(null);try{let{error:e}=await Y.from("categories").delete().match({id:ei.id});if(e)throw e;X('Category "'.concat(ei.name,'" deleted successfully.')),eo()}catch(e){console.error("Error deleting category:",e),Z("Failed to delete category: ".concat(e.message))}finally{D(!1),ea(!1),en(null)}}},ex=e=>{en(e),ea(!0)};return(0,s.jsxs)(n.A,{maxWidth:"xl",sx:{py:3},children:[(0,s.jsx)(o.A,{elevation:0,sx:{p:3,mb:3,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",borderRadius:2,border:"1px solid",borderColor:"primary.main"},children:(0,s.jsxs)(c.A,{direction:"row",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2,children:[(0,s.jsxs)(c.A,{direction:"row",alignItems:"center",spacing:2,children:[(0,s.jsx)(l.A,{variant:"h4",component:"h1",fontWeight:"bold",children:"Categories"}),(0,s.jsx)(d.A,{icon:(0,s.jsx)(V.A,{}),label:"Total Categories: ".concat(t.length),variant:"filled",sx:{backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white",fontWeight:"bold","& .MuiChip-icon":{color:"white"}}})]}),(0,s.jsxs)(c.A,{direction:"row",spacing:1,children:[(0,s.jsx)(h.A,{variant:"contained",startIcon:(0,s.jsx)(P.A,{}),onClick:()=>{if(0===t.length)return;let e=new Blob([[["Name","Slug"],...t.map(e=>[e.name,e.slug||"N/A"])].map(e=>e.join(",")).join("\n")],{type:"text/csv"}),r=window.URL.createObjectURL(e),s=document.createElement("a");s.href=r,s.download="categories.csv",s.click(),window.URL.revokeObjectURL(r)},disabled:0===t.length,sx:{backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.3)"}},children:"Download CSV"}),(0,s.jsx)(h.A,{variant:"contained",startIcon:(0,s.jsx)(O.A,{}),onClick:()=>{eo()},sx:{backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.3)"}},children:"Refresh"}),(0,s.jsx)(h.A,{variant:"contained",startIcon:(0,s.jsx)(J.A,{}),onClick:()=>{q.push("/dashboard/categories/new")},sx:{backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.3)"}},children:"Add New Category"})]})]})}),(0,s.jsxs)(R.N,{children:[T&&(0,s.jsx)(_.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:(0,s.jsx)(u.A,{severity:"error",sx:{mb:2},children:T})}),G&&(0,s.jsx)(_.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:(0,s.jsx)(u.A,{severity:"success",sx:{mb:2},children:G})})]}),(0,s.jsx)(o.A,{elevation:1,sx:{p:2,mb:3,borderRadius:2},children:(0,s.jsxs)(c.A,{direction:"row",spacing:2,alignItems:"center",children:[(0,s.jsx)(x.A,{fullWidth:!0,placeholder:"Search categories...",value:Q,onChange:e=>el(e.target.value),InputProps:{startAdornment:(0,s.jsx)(g.A,{position:"start",children:(0,s.jsx)(F.A,{color:"action"})})},sx:{flexGrow:1}}),(0,s.jsx)(h.A,{variant:"outlined",startIcon:(0,s.jsx)(E.A,{}),onClick:()=>ee(!0),children:"Filters"})]})}),U?(0,s.jsxs)(A.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:200},children:[(0,s.jsx)(j.A,{size:40}),(0,s.jsx)(l.A,{variant:"body1",sx:{ml:2},children:"Loading categories..."})]}):(0,s.jsx)(o.A,{elevation:1,sx:{borderRadius:2,overflow:"hidden"},children:0===t.length?(0,s.jsxs)(A.A,{sx:{p:4,textAlign:"center"},children:[(0,s.jsx)(V.A,{sx:{fontSize:64,color:"text.secondary",mb:2}}),(0,s.jsx)(l.A,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No categories found"}),(0,s.jsxs)(l.A,{variant:"body2",color:"text.secondary",children:[Q?"Try different search terms or":"Add some categories to get started or"," adjust your filters."]})]}):(0,s.jsx)(m.A,{children:t.map((e,r)=>(0,s.jsxs)(a.Fragment,{children:[(0,s.jsxs)(v.Ay,{sx:{py:2,"&:hover":{backgroundColor:"action.hover"}},children:[(0,s.jsx)(y.A,{primary:(0,s.jsx)(l.A,{variant:"h6",fontWeight:"medium",children:e.name}),secondary:e.slug&&(0,s.jsxs)(l.A,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:["Slug: ",e.slug]})}),(0,s.jsxs)(c.A,{direction:"row",spacing:1,children:[(0,s.jsx)(p.A,{color:"primary",onClick:()=>eh(e.id),children:(0,s.jsx)(M.A,{})}),(0,s.jsx)(p.A,{color:"error",onClick:()=>ex(e),children:(0,s.jsx)(W.A,{})})]})]}),r<t.length-1&&(0,s.jsx)(b.A,{})]},e.id))})}),(0,s.jsx)(f.Ay,{anchor:"right",open:$,onClose:()=>ee(!1),children:(0,s.jsxs)(A.A,{sx:{width:300,p:3},children:[(0,s.jsx)(l.A,{variant:"h6",gutterBottom:!0,children:"Filter Categories"}),(0,s.jsxs)(c.A,{spacing:3,children:[(0,s.jsxs)(C.A,{fullWidth:!0,children:[(0,s.jsx)(w.A,{children:"Sort By"}),(0,s.jsxs)(k.A,{value:er.sortBy,onChange:e=>et({...er,sortBy:e.target.value}),label:"Sort By",children:[(0,s.jsx)(I.A,{value:"name_asc",children:"Name (A-Z)"}),(0,s.jsx)(I.A,{value:"name_desc",children:"Name (Z-A)"}),(0,s.jsx)(I.A,{value:"newest",children:"Newest First"}),(0,s.jsx)(I.A,{value:"oldest",children:"Oldest First"})]})]}),(0,s.jsxs)(c.A,{direction:"row",spacing:2,children:[(0,s.jsx)(h.A,{variant:"outlined",fullWidth:!0,onClick:()=>{et({sortBy:"name_asc"}),ed({sortBy:"name_asc"})},children:"Clear"}),(0,s.jsx)(h.A,{variant:"contained",fullWidth:!0,onClick:()=>ed(er),children:"Apply"})]})]})]})}),(0,s.jsxs)(S.A,{open:es,onClose:()=>ea(!1),maxWidth:"sm",fullWidth:!0,children:[(0,s.jsx)(z.A,{children:"Confirm Delete"}),(0,s.jsx)(N.A,{children:(0,s.jsxs)(l.A,{children:['Are you sure you want to delete the category "',null==ei?void 0:ei.name,'"? This might affect existing cards and sets.']})}),(0,s.jsxs)(B.A,{children:[(0,s.jsx)(h.A,{onClick:()=>ea(!1),children:"Cancel"}),(0,s.jsx)(h.A,{onClick:eu,color:"error",variant:"contained",disabled:U,children:U?(0,s.jsx)(j.A,{size:20}):"Delete"})]})]})]})}},26924:(e,r,t)=>{Promise.resolve().then(t.bind(t,9521))},28890:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});var s=t(57515),a=t(95155);let i=(0,s.A)((0,a.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},35695:(e,r,t)=>{"use strict";var s=t(18999);t.o(s,"useParams")&&t.d(r,{useParams:function(){return s.useParams}}),t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}})},37857:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});var s=t(57515),a=t(95155);let i=(0,s.A)((0,a.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh")},40510:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});var s=t(57515),a=t(95155);let i=(0,s.A)((0,a.jsx)("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download")},40857:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});var s=t(57515),a=t(95155);let i=(0,s.A)((0,a.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},55954:(e,r,t)=>{"use strict";t.d(r,{U:()=>a});var s=t(81935);function a(){return(0,s.createBrowserClient)("https://zyqebttgsbkjarthknns.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp5cWVidHRnc2JramFydGhrbm5zIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgwNzkxNzcsImV4cCI6MjA2MzY1NTE3N30.o3K5QGPT-BL6y9iBnn4oaxkrD-Oed6mW3TALFk4vqJ8")}},63954:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});var s=t(57515),a=t(95155);let i=(0,s.A)((0,a.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")},94424:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});var s=t(57515),a=t(95155);let i=(0,s.A)((0,a.jsx)("path",{d:"M10 18h4v-2h-4zM3 6v2h18V6zm3 7h12v-2H6z"}),"FilterList")}},e=>{var r=r=>e(e.s=r);e.O(0,[1935,4127,5158,2842,9295,4801,8449,6153,1101,8987,8939,9788,8441,1684,7358],()=>r(26924)),_N_E=e.O()}]);