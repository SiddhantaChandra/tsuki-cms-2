(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8733],{35695:(e,s,r)=>{"use strict";var t=r(18999);r.o(t,"useParams")&&r.d(s,{useParams:function(){return t.useParams}}),r.o(t,"useRouter")&&r.d(s,{useRouter:function(){return t.useRouter}})},38743:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>u});var t=r(95155),a=r(12115),i=r(55954);async function n(e){let s=(0,i.U)(),{data:{session:r}}=await s.auth.getSession();if(!r)return!1;let{data:t,error:a}=await s.from("user_roles").select("*").eq("user_id",r.user.id).eq("role",e).single();return!a&&!!t}async function l(e,s){let r=(0,i.U)(),{data:t,error:a}=await r.from("user_roles").insert([{user_id:e,role:s}]);return!a}async function c(e,s){let r=(0,i.U)(),{error:t}=await r.from("user_roles").delete().eq("user_id",e).eq("role",s);return!t}async function d(){let e=(0,i.U)(),{data:s,error:r}=await e.auth.admin.listUsers();return!r&&(null==s?void 0:s.users)?await Promise.all(s.users.map(async s=>{let{data:r}=await e.from("user_roles").select("role").eq("user_id",s.id);return{id:s.id,email:s.email,roles:r?r.map(e=>e.role):[]}})):[]}var o=r(35695);function u(){let[e,s]=(0,a.useState)([]),[r,i]=(0,a.useState)(!0),{hasRole:u,loading:h}=function(e){let[s,r]=(0,a.useState)(!0),[t,i]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{(async()=>{r(!0),i(await n(e)),r(!1)})()},[e]),{loading:s,hasRole:t}}("admin"),m=(0,o.useRouter)();(0,a.useEffect)(()=>{(async()=>{i(!0),s(await d()),i(!1)})()},[]),(0,a.useEffect)(()=>{h||u||m.push("/")},[h,u,m]);let x=async(e,r,t)=>{t?await c(e,r):await l(e,r),s(await d())};return h||r?(0,t.jsx)("div",{className:"p-8",children:"Loading..."}):u?(0,t.jsxs)("div",{className:"p-8",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"User Role Management"}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full bg-white border border-gray-200",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-gray-100",children:[(0,t.jsx)("th",{className:"py-2 px-4 border-b text-left",children:"Email"}),(0,t.jsx)("th",{className:"py-2 px-4 border-b text-center",children:"Admin"}),(0,t.jsx)("th",{className:"py-2 px-4 border-b text-center",children:"Editor"}),(0,t.jsx)("th",{className:"py-2 px-4 border-b text-center",children:"Viewer"})]})}),(0,t.jsx)("tbody",{children:e.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"py-2 px-4 border-b",children:e.email}),(0,t.jsx)("td",{className:"py-2 px-4 border-b text-center",children:(0,t.jsx)("input",{type:"checkbox",checked:e.roles.includes("admin"),onChange:()=>x(e.id,"admin",e.roles.includes("admin")),className:"h-4 w-4"})}),(0,t.jsx)("td",{className:"py-2 px-4 border-b text-center",children:(0,t.jsx)("input",{type:"checkbox",checked:e.roles.includes("editor"),onChange:()=>x(e.id,"editor",e.roles.includes("editor")),className:"h-4 w-4"})}),(0,t.jsx)("td",{className:"py-2 px-4 border-b text-center",children:(0,t.jsx)("input",{type:"checkbox",checked:e.roles.includes("viewer"),onChange:()=>x(e.id,"viewer",e.roles.includes("viewer")),className:"h-4 w-4"})})]},e.id))})]})})]}):null}},55954:(e,s,r)=>{"use strict";r.d(s,{U:()=>a});var t=r(81935);function a(){return(0,t.createBrowserClient)("https://zyqebttgsbkjarthknns.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp5cWVidHRnc2JramFydGhrbm5zIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgwNzkxNzcsImV4cCI6MjA2MzY1NTE3N30.o3K5QGPT-BL6y9iBnn4oaxkrD-Oed6mW3TALFk4vqJ8")}},86753:(e,s,r)=>{Promise.resolve().then(r.bind(r,38743))}},e=>{var s=s=>e(e.s=s);e.O(0,[1935,8441,1684,7358],()=>s(86753)),_N_E=e.O()}]);