(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4266],{33391:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ed});var a=r(95155),s=r(12115),i=r(16324),l=r(67217),n=r(54581),o=r(700),c=r(68534),d=r(4420),u=r(92302),h=r(14426),x=r(56278),m=r(54492),g=r(99927),j=r(76871),A=r(4915),p=r(33613),b=r(71977),f=r(6874),y=r.n(f),v=r(35695),C=r(55954),S=r(41218),w=r(72110),E=r(16632),k=r(18407),_=r(71803),P=r(78449),I=r(33989),U=r(27088),N=r(17348),D=r(68104),F=r(76380),T=r(74964),W=r(26564),q=r(35297),z=r(3127),L=r(41101),R=r(14962),O=r(2652),M=r(15760),J=r(92683),B=r(51368);r(96262);var H=r(76408),G=r(60760),Y=r(80946),K=r(88806),X=r(46108),Q=r(91058),V=r(51935),Z=r(68558),$=r(7304),ee=r(19505),et=r(28890),er=r(52671),ea=r(71820),es=r(57773),ei=r(58674),el=r(69242);let en=(0,H.P)(S.A);function eo(e){var t;let{initialCardData:r,initialCategories:l,onFormSubmitSuccess:d}=e,j=(0,C.U)(),A=(0,i.A)(),{showToast:p}=(0,J.d)(),[b,f]=(0,s.useState)(""),[y,v]=(0,s.useState)(""),[S,eo]=(0,s.useState)(""),[ec,ed]=(0,s.useState)(""),[eu,eh]=(0,s.useState)(""),[ex,em]=(0,s.useState)(""),[eg,ej]=(0,s.useState)("Japanese"),[eA,ep]=(0,s.useState)(l||[]),[eb,ef]=(0,s.useState)([]),[ey,ev]=(0,s.useState)([]),[eC,eS]=(0,s.useState)(!1),[ew,eE]=(0,s.useState)(null),[ek,e_]=(0,s.useState)(null),[eP,eI]=(0,s.useState)(!1),[eU,eN]=(0,s.useState)(!1),[eD,eF]=(0,s.useState)(null),[eT,eW]=(0,s.useState)([]),[eq,ez]=(0,s.useState)(null),[eL,eR]=(0,s.useState)([]),[eO,eM]=(0,s.useState)(null),[eJ,eB]=(0,s.useState)(!1),[eH,eG]=(0,s.useState)(!1),[eY,eK]=(0,s.useState)(null),[eX,eQ]=(0,s.useState)({});(0,s.useEffect)(()=>{if(r){let e={name:r.name||"",category:r.category_id||"",set:r.set_id||"",subset:r.subset_id||"",price:r.price?String(r.price):"",condition:r.condition||"",language:r.language||"Japanese",imageUrls:r.image_urls||[],thumbnailUrl:r.thumbnail_url||null};f(e.name),v(e.category),eo(e.set),ed(e.subset),eh(e.price),em(e.condition),ej(e.language),eR(e.imageUrls),eM(e.thumbnailUrl),eQ(e)}},[r]),(0,s.useEffect)(()=>{let e={name:b,category:y,set:S,subset:ec,price:eu,condition:ex,language:eg,imageUrls:eL,thumbnailUrl:eO};eI(e.name!==eX.name||e.category!==eX.category||e.set!==eX.set||e.subset!==eX.subset||e.price!==eX.price||e.condition!==eX.condition||e.language!==eX.language||JSON.stringify(e.imageUrls)!==JSON.stringify(eX.imageUrls)||e.thumbnailUrl!==eX.thumbnailUrl||eJ||eH)},[b,y,S,ec,eu,ex,eg,eL,eO,eX,eJ,eH]),(0,s.useEffect)(()=>{ep(l||[])},[l]),(0,s.useEffect)(()=>{y?(async()=>{try{let{data:e,error:t}=await j.from("sets").select("id, name").eq("category_id",y);if(t)throw t;ef(e||[])}catch(e){console.error("Error fetching sets:",e)}})():ef([])},[y,j]),(0,s.useEffect)(()=>{S?(async()=>{try{let{data:e,error:t}=await j.from("subsets").select("id, name").eq("set_id",S);if(t)throw t;ev(e||[])}catch(e){console.error("Error fetching subsets:",e)}})():ev([])},[S,j]);let eV=async e=>{try{eE(null),eS(!0);let{error:t}=await j.from("cards").update({thumbnail_url:e}).eq("id",r.id);if(t)throw t;eM(e),p("Thumbnail updated successfully!",{severity:"success",title:"Success"})}catch(t){let e="Failed to update thumbnail: ".concat(t.message);eE(e),p(e,{severity:"error",title:"Error"})}finally{eS(!1)}},eZ=async e=>{try{eE(null),eS(!0);let t=eL.filter(t=>t!==e),a=e===eO,s={image_urls:t};a&&(s.thumbnail_url=null);let{error:i}=await j.from("cards").update(s).eq("id",r.id);if(i)throw i;eR(t),a&&eM(null),p("Image removed successfully!",{severity:"success",title:"Success"})}catch(t){let e="Failed to remove image: ".concat(t.message);eE(e),p(e,{severity:"error",title:"Error"})}finally{eS(!1)}},e$=async e=>{if(e.preventDefault(),eS(!0),eE(null),e_(null),!b.trim()){eE("Card Name is required."),eS(!1);return}let t=parseFloat(eu);if(isNaN(t)||t<=0){eE("Price must be a positive number."),eS(!1);return}try{let e={name:b.trim(),category_id:y,set_id:S,subset_id:ec,price:t,condition:ex.trim(),language:eg.trim()};if(eJ){let t=[];for(let e of eT){let r=new Date,a=r.getFullYear(),s=(r.getMonth()+1).toString().padStart(2,"0"),i=r.getDate().toString().padStart(2,"0"),l="cards/".concat(a,"/").concat(s,"/").concat(i,"/").concat((0,B.A)(),".webp"),{error:n}=await j.storage.from("cardimages").upload(l,e,{contentType:e.type,upsert:!1});if(n)throw n;let{data:{publicUrl:o}}=j.storage.from("cardimages").getPublicUrl(l);t.push(o)}e.image_urls=[...eL,...t]}if(eH&&eq){let t=new Date,r=t.getFullYear(),a=(t.getMonth()+1).toString().padStart(2,"0"),s=t.getDate().toString().padStart(2,"0"),i="cards/".concat(r,"/").concat(a,"/").concat(s,"/").concat((0,B.A)(),"_thumb.webp"),{error:l}=await j.storage.from("cardimages").upload(i,eq,{contentType:eq.type,upsert:!1});if(l)throw l;let{data:{publicUrl:n}}=j.storage.from("cardimages").getPublicUrl(i);e.thumbnail_url=n}let{error:a}=await j.from("cards").update(e).eq("id",r.id);if(a)throw a;e_("Card updated successfully!"),p("Card updated successfully!",{severity:"success",title:"Success"}),d&&setTimeout(()=>{d()},1500)}catch(t){let e="Operation failed: ".concat(t.message);eE(e),p(e,{severity:"error",title:"Error"})}finally{eS(!1)}},e0=e=>{eF(e),eN(!0)};return(0,a.jsxs)(n.A,{sx:{maxWidth:800,mx:"auto",p:3},children:[(0,a.jsx)(o.A,{variant:"h4",component:"h1",gutterBottom:!0,sx:{fontWeight:700,mb:3},children:"Edit Card"}),(0,a.jsxs)(w.A,{container:!0,spacing:2,sx:{mb:4},children:[(0,a.jsx)(w.A,{item:!0,xs:12,sm:6,md:3,children:(0,a.jsx)(en,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:(0,a.jsxs)(E.A,{sx:{textAlign:"center"},children:[(0,a.jsx)(er.A,{color:"primary"}),(0,a.jsx)(o.A,{variant:"h6",children:eL.length}),(0,a.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"Images"})]})})}),(0,a.jsx)(w.A,{item:!0,xs:12,sm:6,md:3,children:(0,a.jsx)(en,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:(0,a.jsxs)(E.A,{sx:{textAlign:"center"},children:[(0,a.jsx)(es.A,{color:"success"}),(0,a.jsxs)(o.A,{variant:"h6",children:["â‚¹",eu||"0"]}),(0,a.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"Current Price"})]})})}),(0,a.jsx)(w.A,{item:!0,xs:12,sm:6,md:3,children:(0,a.jsx)(en,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:(0,a.jsxs)(E.A,{sx:{textAlign:"center"},children:[(0,a.jsx)(K.A,{color:"info"}),(0,a.jsx)(o.A,{variant:"h6",children:(null==(t=eA.find(e=>e.id===y))?void 0:t.name)||"N/A"}),(0,a.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"Category"})]})})}),(0,a.jsx)(w.A,{item:!0,xs:12,sm:6,md:3,children:(0,a.jsx)(en,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:(0,a.jsxs)(E.A,{sx:{textAlign:"center"},children:[(0,a.jsx)(et.A,{color:"warning"}),(0,a.jsx)(o.A,{variant:"h6",children:eP?"Modified":"No Changes"}),(0,a.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"Status"})]})})})]}),(0,a.jsx)(k.A,{elevation:0,sx:{borderRadius:2,overflow:"hidden"},children:(0,a.jsxs)(n.A,{component:"form",onSubmit:e$,sx:{p:3},children:[(0,a.jsxs)(G.N,{children:[ew&&(0,a.jsx)(H.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:(0,a.jsx)(u.A,{severity:"error",sx:{mb:3},onClose:()=>eE(null),children:ew})}),ek&&(0,a.jsx)(H.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:(0,a.jsx)(u.A,{severity:"success",sx:{mb:3},onClose:()=>e_(null),children:ek})})]}),(0,a.jsxs)(n.A,{sx:{mb:4},children:[(0,a.jsxs)(o.A,{variant:"h6",sx:{mb:3,display:"flex",alignItems:"center",gap:1},children:[(0,a.jsx)(Y.A,{color:"primary"}),"Basic Information"]}),(0,a.jsxs)(_.A,{spacing:3,children:[(0,a.jsx)(P.A,{fullWidth:!0,label:"Card Name",value:b,onChange:e=>f(e.target.value),required:!0,InputProps:{startAdornment:(0,a.jsx)(I.A,{position:"start",children:(0,a.jsx)(es.A,{color:"action"})})}}),(0,a.jsxs)(w.A,{container:!0,spacing:2,children:[(0,a.jsx)(w.A,{item:!0,xs:12,sm:6,children:(0,a.jsx)(P.A,{fullWidth:!0,label:"Price",type:"number",value:eu,onChange:e=>eh(e.target.value),InputProps:{inputProps:{min:0,step:"0.01"},startAdornment:(0,a.jsx)(I.A,{position:"start",children:(0,a.jsx)(Q.A,{color:"action"})})},required:!0})}),(0,a.jsx)(w.A,{item:!0,xs:12,sm:6,children:(0,a.jsxs)(U.A,{fullWidth:!0,required:!0,children:[(0,a.jsx)(N.A,{children:"Language"}),(0,a.jsxs)(D.A,{value:eg,label:"Language",onChange:e=>ej(e.target.value),startAdornment:(0,a.jsx)(I.A,{position:"start",children:(0,a.jsx)(ea.A,{color:"action"})}),children:[(0,a.jsx)(F.A,{value:"Japanese",children:"Japanese"}),(0,a.jsx)(F.A,{value:"English",children:"English"})]})]})})]}),(0,a.jsxs)(n.A,{children:[(0,a.jsx)(o.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Condition"}),(0,a.jsxs)(U.A,{fullWidth:!0,required:!0,children:[(0,a.jsx)(N.A,{children:"Condition"}),(0,a.jsxs)(D.A,{value:ex,label:"Condition",onChange:e=>em(e.target.value),children:[(0,a.jsx)(F.A,{value:"10",children:"Gem Mint"}),(0,a.jsx)(F.A,{value:"9",children:"Mint"}),(0,a.jsx)(F.A,{value:"8",children:"Near Mint"}),(0,a.jsx)(F.A,{value:"7",children:"Excellent"}),(0,a.jsx)(F.A,{value:"6",children:"Good"}),(0,a.jsx)(F.A,{value:"5",children:"Fair"}),(0,a.jsx)(F.A,{value:"4",children:"Poor"})]})]})]})]})]}),(0,a.jsx)(T.A,{sx:{my:4}}),(0,a.jsxs)(n.A,{sx:{mb:4},children:[(0,a.jsxs)(o.A,{variant:"h6",sx:{mb:3,display:"flex",alignItems:"center",gap:1},children:[(0,a.jsx)(K.A,{color:"primary"}),"Classification"]}),(0,a.jsxs)(_.A,{spacing:3,children:[(0,a.jsxs)(U.A,{fullWidth:!0,required:!0,children:[(0,a.jsx)(N.A,{children:"Category"}),(0,a.jsxs)(D.A,{value:y,label:"Category",onChange:e=>v(e.target.value),children:[(0,a.jsx)(F.A,{value:"",children:(0,a.jsx)("em",{children:"Select Category"})}),eA.map(e=>(0,a.jsx)(F.A,{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)(U.A,{fullWidth:!0,required:!0,disabled:!y,children:[(0,a.jsx)(N.A,{children:"Set"}),(0,a.jsxs)(D.A,{value:S,label:"Set",onChange:e=>eo(e.target.value),children:[(0,a.jsx)(F.A,{value:"",children:(0,a.jsx)("em",{children:"Select Set"})}),eb.map(e=>(0,a.jsx)(F.A,{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)(U.A,{fullWidth:!0,required:!0,disabled:!S,children:[(0,a.jsx)(N.A,{children:"Subset"}),(0,a.jsxs)(D.A,{value:ec,label:"Subset",onChange:e=>ed(e.target.value),children:[(0,a.jsx)(F.A,{value:"",children:(0,a.jsx)("em",{children:"Select Subset"})}),ey.map(e=>(0,a.jsx)(F.A,{value:e.id,children:e.name},e.id))]})]})]})]}),(0,a.jsx)(T.A,{sx:{my:4}}),(0,a.jsxs)(n.A,{sx:{mb:4},children:[(0,a.jsxs)(o.A,{variant:"h6",sx:{mb:3,display:"flex",alignItems:"center",gap:1},children:[(0,a.jsx)(er.A,{color:"primary"}),"Images & Thumbnail",(0,a.jsx)(W.A,{badgeContent:eL.length,color:"primary",children:(0,a.jsx)(n.A,{})})]}),eL.length>0&&(0,a.jsxs)(n.A,{sx:{mb:3},children:[(0,a.jsx)(o.A,{variant:"subtitle1",sx:{mb:2,fontWeight:600},children:"Current Images"}),(0,a.jsx)(w.A,{container:!0,spacing:2,children:eL.map((e,t)=>(0,a.jsx)(w.A,{item:!0,xs:6,sm:4,md:3,children:(0,a.jsxs)(en,{whileHover:{scale:1.02},sx:{position:"relative",overflow:"hidden",borderRadius:2,border:e===eO?"2px solid ".concat(A.palette.warning.main):"none"},children:[(0,a.jsxs)(n.A,{sx:{position:"relative",paddingTop:"140%",cursor:"pointer","&:hover .image-overlay":{opacity:1}},onClick:()=>e0(e),children:[(0,a.jsx)(n.A,{component:"img",src:e,alt:"Card image ".concat(t+1),sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover"}}),(0,a.jsxs)(n.A,{className:"image-overlay",sx:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 100%)",opacity:0,transition:"opacity 0.3s ease",display:"flex",flexDirection:"column",justifyContent:"space-between",p:1},children:[(0,a.jsxs)(n.A,{sx:{display:"flex",justifyContent:"flex-end",gap:.5},children:[(0,a.jsx)(q.A,{title:e===eO?"Current thumbnail":"Set as thumbnail",children:(0,a.jsx)(z.A,{size:"small",onClick:t=>{t.stopPropagation(),eV(e)},sx:{backgroundColor:"rgba(0,0,0,0.5)",color:"#fff","&:hover":{backgroundColor:"rgba(0,0,0,0.7)"}},children:e===eO?(0,a.jsx)(Z.A,{fontSize:"small"}):(0,a.jsx)($.A,{fontSize:"small"})})}),(0,a.jsx)(q.A,{title:"Remove image",children:(0,a.jsx)(z.A,{size:"small",onClick:t=>{t.stopPropagation(),eZ(e)},sx:{backgroundColor:"rgba(0,0,0,0.5)",color:"#fff","&:hover":{backgroundColor:"rgba(255,0,0,0.5)"}},children:(0,a.jsx)(ee.A,{fontSize:"small"})})})]}),(0,a.jsx)(n.A,{sx:{textAlign:"center"},children:(0,a.jsx)(L.A,{icon:(0,a.jsx)(ei.A,{}),label:"Click to preview",size:"small",sx:{backgroundColor:"rgba(255,255,255,0.9)",fontSize:"0.7rem"}})})]})]}),e===eO&&(0,a.jsx)(L.A,{label:"Thumbnail",size:"small",color:"warning",sx:{position:"absolute",bottom:8,left:8,fontWeight:600}})]})},t))})]}),(0,a.jsx)(T.A,{sx:{my:3}}),(0,a.jsxs)(n.A,{children:[(0,a.jsx)(o.A,{variant:"subtitle1",sx:{mb:2,fontWeight:600},children:"Add New Images"}),(0,a.jsx)(u.A,{severity:"info",sx:{mb:2},children:"Upload new images to add to the existing collection. New images will be appended, not replaced."}),(0,a.jsx)(M.A,{bucketName:"cardimages",pathPrefix:"cards",onUploadComplete:e=>{let{mainImageFiles:t,thumbnailImageFile:r}=e;t&&t.length>0&&(eW(t),eB(!0)),r&&(ez(r),eG(!0))}},"image-uploader-edit"),(eT.length>0||eq)&&(0,a.jsx)(R.A,{in:!0,children:(0,a.jsxs)(u.A,{severity:"success",sx:{mt:2},icon:(0,a.jsx)(X.A,{}),children:[eT.length>0&&"".concat(eT.length," new image(s) ready to upload. "),eq&&"New thumbnail selected."]})})]})]}),(0,a.jsx)(T.A,{sx:{my:3}}),(0,a.jsxs)(_.A,{direction:"row",spacing:2,justifyContent:"flex-end",children:[(0,a.jsx)(c.A,{variant:"outlined",onClick:()=>window.history.back(),disabled:eC,children:"Cancel"}),(0,a.jsx)(c.A,{type:"submit",variant:"contained",disabled:eC||!eP,startIcon:eC?(0,a.jsx)(h.A,{size:20}):(0,a.jsx)(V.A,{}),sx:{minWidth:150,background:eP&&!eC?"linear-gradient(45deg, ".concat(A.palette.primary.main," 30%, ").concat(A.palette.secondary.main," 90%)"):void 0},children:eC?"Saving...":eP?"Save Changes":"No Changes"})]})]})}),(0,a.jsxs)(x.A,{open:eU,onClose:()=>eN(!1),maxWidth:"md",fullWidth:!0,TransitionComponent:O.A,children:[(0,a.jsxs)(m.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:["Image Preview",(0,a.jsx)(z.A,{onClick:()=>eN(!1),children:(0,a.jsx)(el.A,{})})]}),(0,a.jsx)(g.A,{sx:{p:0},children:eD&&(0,a.jsx)(n.A,{component:"img",src:eD,alt:"Preview",sx:{width:"100%",height:"auto",maxHeight:"80vh",objectFit:"contain"}})})]})]})}(0,H.P)(n.A);var ec=r(38464);function ed(){let e=(0,v.useRouter)(),t=(0,v.useParams)().id,r=(0,C.U)(),f=(0,i.A)(),[S,w]=(0,s.useState)(null),[E,k]=(0,s.useState)([]),[_,P]=(0,s.useState)(!0),[I,U]=(0,s.useState)(null),[N,D]=(0,s.useState)(!1),[F,T]=(0,s.useState)(!1),[W,q]=(0,s.useState)(!1),[z,L]=(0,s.useState)(null),R=(0,s.useCallback)(async()=>{P(!0),U(null);try{let{data:e,error:a}=await r.from("cards").select("*").eq("id",t).single();if(a)throw Error("Failed to load card: ".concat(a.message));if(!e)throw Error("Card not found");w(e);let{data:s,error:i}=await r.from("categories").select("id, name");if(i)throw Error("Failed to load categories: ".concat(i.message));k(s||[])}catch(e){console.error("Error loading data:",e),U(e.message)}finally{P(!1)}},[r,t]);(0,s.useEffect)(()=>{R()},[R]);let O=async()=>{T(!0),L(null);try{if(console.log("Starting card deletion process for ID:",t),W)console.log("Force delete enabled - skipping image deletion");else{if(S.image_urls&&S.image_urls.length>0)for(let e of(console.log("Attempting to delete",S.image_urls.length,"images"),S.image_urls))try{console.log("Processing image URL:",e);let t=e.match(/\/storage\/v1\/object\/public\/cardimages\/(.*)/);if(t&&t[1]){let e=t[1];console.log("Extracted file path:",e);let{data:a,error:s}=await r.storage.from("cardimages").remove([e]);s?console.error("Failed to delete image:",s):console.log("Successfully deleted image from storage")}else console.log("Could not extract path from URL:",e)}catch(e){console.error("Error processing image deletion:",e)}if(S.thumbnail_url)try{console.log("Processing thumbnail URL:",S.thumbnail_url);let e=S.thumbnail_url.match(/\/storage\/v1\/object\/public\/cardimages\/(.*)/);if(e&&e[1]){let t=e[1];console.log("Extracted thumbnail path:",t);let{data:a,error:s}=await r.storage.from("cardimages").remove([t]);s?console.error("Failed to delete thumbnail:",s):console.log("Successfully deleted thumbnail from storage")}else console.log("Could not extract path from thumbnail URL:",S.thumbnail_url)}catch(e){console.error("Error processing thumbnail deletion:",e)}}console.log("Attempting to delete card from database with ID:",t);let{data:a,error:s}=await r.from("cards").delete().eq("id",t);if(console.log("Delete operation response:",{data:a,error:s}),s)throw console.error("Database deletion error details:",s),L(s),Error("Failed to delete card: ".concat(s.message));console.log("Card successfully deleted from database"),D(!1),e.push("/dashboard/cards")}catch(e){console.error("Error deleting card:",e),U("Failed to delete card: ".concat(e.message))}finally{T(!1)}};return(0,a.jsxs)(l.A,{maxWidth:"lg",children:[(0,a.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,a.jsx)(o.A,{variant:"h4",component:"h1",children:"Edit Card"}),(0,a.jsxs)(n.A,{sx:{display:"flex",gap:2},children:[(0,a.jsx)(c.A,{component:y(),href:"/dashboard/cards",variant:"outlined",startIcon:(0,a.jsx)(ec.A,{}),sx:{borderColor:"rgba(255,255,255,0.3)",color:"#fff","&:hover":{borderColor:"rgba(255,255,255,0.6)",backgroundColor:"rgba(255,255,255,0.1)"}},children:"BACK TO COLLECTION"}),(0,a.jsx)(c.A,{variant:"contained",color:"error",startIcon:(0,a.jsx)(ee.A,{}),onClick:()=>D(!0),sx:{"&:hover":{backgroundColor:(0,d.X4)(f.palette.error.main,.8)}},children:"DELETE"})]})]}),I&&(0,a.jsx)(u.A,{severity:"error",sx:{mb:3},children:I}),_?(0,a.jsxs)(n.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:5,backgroundColor:"rgba(30, 30, 30, 0.8)",borderRadius:"8px"},children:[(0,a.jsx)(h.A,{}),(0,a.jsx)(o.A,{sx:{mt:2,color:"#fff"},children:"Loading card data..."})]}):(0,a.jsx)(eo,{initialCardData:S,initialCategories:E,onFormSubmitSuccess:()=>{e.push("/dashboard/cards")}}),(0,a.jsxs)(x.A,{open:N,onClose:()=>!F&&D(!1),PaperProps:{sx:{backgroundColor:"#1E1E1E",color:"#fff",borderRadius:"8px"}},children:[(0,a.jsx)(m.A,{children:"Delete Card"}),(0,a.jsxs)(g.A,{children:[(0,a.jsx)(j.A,{sx:{color:"rgba(255, 255, 255, 0.8)"},children:"Are you sure you want to delete this card? This action cannot be undone and will remove all associated images from storage."}),z&&(0,a.jsxs)(u.A,{severity:"error",sx:{mt:2},children:[(0,a.jsxs)(o.A,{variant:"body2",children:["Error Code: ",z.code]}),(0,a.jsxs)(o.A,{variant:"body2",children:["Message: ",z.message]}),(0,a.jsxs)(o.A,{variant:"body2",children:["Details: ",z.details]}),(0,a.jsxs)(o.A,{variant:"body2",children:["Hint: ",z.hint]})]}),(0,a.jsx)(A.A,{control:(0,a.jsx)(p.A,{checked:W,onChange:e=>q(e.target.checked),sx:{color:f.palette.error.main}}),label:"Force delete (skip image deletion)",sx:{mt:2,color:f.palette.error.main}})]}),(0,a.jsxs)(b.A,{sx:{p:2},children:[(0,a.jsx)(c.A,{onClick:()=>D(!1),color:"primary",disabled:F,children:"Cancel"}),(0,a.jsx)(c.A,{onClick:O,variant:"contained",color:"error",disabled:F,startIcon:F?(0,a.jsx)(h.A,{size:20}):(0,a.jsx)(ee.A,{}),autoFocus:!0,children:F?"Deleting...":"Delete"})]})]})]})}},50372:(e,t,r)=>{Promise.resolve().then(r.bind(r,33391))},92683:(e,t,r)=>{"use strict";r.d(t,{ToastProvider:()=>c,d:()=>d});var a=r(95155),s=r(12115),i=r(35726),l=r(92302),n=r(89880);let o=(0,s.createContext)({showToast:()=>{},hideToast:()=>{}});function c(e){let{children:t}=e,[r,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(""),[h,x]=(0,s.useState)(""),[m,g]=(0,s.useState)("info"),[j,A]=(0,s.useState)(5e3),p=()=>{c(!1)},b=(e,t)=>{"clickaway"!==t&&p()};return(0,a.jsxs)(o.Provider,{value:{showToast:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{title:r,severity:a,duration:s}=t;u(e),r&&x(r),a&&g(a),s&&A(s),c(!0)},hideToast:p},children:[t,(0,a.jsx)(i.A,{open:r,autoHideDuration:j,onClose:b,anchorOrigin:{vertical:"top",horizontal:"right"},children:(0,a.jsxs)(l.A,{onClose:b,severity:m,variant:"filled",sx:{width:"100%"},children:[h&&(0,a.jsx)(n.A,{children:h}),d]})})]})}function d(){return(0,s.useContext)(o)}}},e=>{var t=t=>e(e.s=t);e.O(0,[3627,1935,4127,5158,2842,9295,4801,8449,2110,6153,6874,1101,2330,5297,9186,5726,8939,6564,276,3567,259,8441,1684,7358],()=>t(50372)),_N_E=e.O()}]);